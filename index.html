<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API QR Code - Philippe Eveilleau</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --text-color: #1f2937;
            --bg-color: #f3f4f6;
            --card-bg: #ffffff;
            --code-bg: #1e293b;
            --code-text: #e2e8f0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 600px;
            width: 100%;
            margin-top: 40px;
            padding: 20px;
        }

        /* Language Switcher */
        .lang-switch {
            text-align: right;
            margin-bottom: 20px;
        }
        .lang-btn {
            background: none;
            border: 1px solid #d1d5db;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #6b7280;
        }
        .lang-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Header Section */
        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #6b7280;
            margin-top: 0;
        }

        /* Lien Inforeole propre */
        .brand-link {
            color: #4b5563;
            text-decoration: none;
            font-weight: 600;
            border-bottom: 1px dotted #9ca3af;
            transition: color 0.2s;
        }
        .brand-link:hover {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        /* Tool Section */
        .card {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        input {
            flex: 1;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            min-width: 200px;
        }

        button.action-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
        }

        button.action-btn:hover {
            background-color: #1d4ed8;
        }

        #preview-container {
            margin-top: 20px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #e5e7eb;
            border-radius: 8px;
            text-align: center;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        /* API Docs Section */
        .api-docs {
            background: #fff;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }

        .api-docs h3 {
            margin-top: 0;
            font-size: 1.2rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 15px;
            border-radius: 6px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin-bottom: 15px;
        }

        .method {
            color: #4ade80;
            font-weight: bold;
            margin-right: 10px;
        }

        .param {
            color: #93c5fd;
        }

        .comment {
            color: #94a3b8;
            display: block;
            margin-bottom: 5px;
        }

        /* Footer / Bio Section */
        footer {
            margin-top: auto;
            padding: 40px 20px;
            text-align: center;
            border-top: 1px solid #e5e7eb;
            width: 100%;
            background: #fff;
        }

        .bio-box {
            max-width: 600px;
            margin: 0 auto;
        }

        .bio-title {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .bio-desc {
            color: #4b5563;
            margin-bottom: 10px;
            font-style: italic;
        }

        a.bio-link {
            color: var(--primary-color);
            text-decoration: none;
        }

        a.bio-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="lang-switch">
            <button onclick="setLanguage('fr')" class="lang-btn active" id="btn-fr">FR</button>
            <button onclick="setLanguage('en')" class="lang-btn" id="btn-en">EN</button>
        </div>

        <header>
            <h1 data-i18n="title">Générateur QR Code API</h1>
            <p class="subtitle">
                <span data-i18n="subtitle">Micro-service offert par</span> 
                <a href="https://inforeole.fr" target="_blank" class="brand-link">
                    Phil, d'Inforeole.fr
                </a>
            </p>
        </header>

        <section class="card">
            <div class="input-group">
                <input type="text" id="inputText" placeholder="Entrez une URL ou du texte à encoder">
                <button onclick="generate()" class="action-btn" data-i18n="generateBtn">Générer</button>
            </div>
            
            <div id="preview-container">
                <span id="placeholder-text" style="color: #9ca3af;" data-i18n="placeholder">Le QR Code apparaîtra ici</span>
                <img id="preview" src="" alt="QR Code" style="display:none;">
            </div>
        </section>

        <section class="api-docs">
            <h3 data-i18n="apiTitle">Documentation pour Développeurs</h3>
            
            <div class="code-block">
                <span class="comment"># <span data-i18n="apiComment1">Format de la requête HTTP</span></span>
                <div><span class="method">GET</span> /api/qr?text=<span class="param">VOTRE_TEXTE_URL_ENCODED</span></div>
            </div>

            <div class="code-block">
                <span class="comment"># <span data-i18n="apiComment2">Exemple cURL / Terminal</span></span>
                curl "https://<span id="host-display">...</span>/api/qr?text=Hello" > qr.png
            </div>

            <div class="code-block">
                <span class="comment"># <span data-i18n="apiComment3">Utilisation dans n8n (HTTP Request Node)</span></span>
                Method: GET<br>
                URL: https://<span id="host-display-2">...</span>/api/qr<br>
                Query Parameter: text = {{ $json.body.url }}<br>
                Response Format: File
            </div>
        </section>
    </div>

    <footer>
        <div class="bio-box">
            <span class="bio-title" data-i18n="bioTitle">À propos de Philippe Eveilleau</span>
            <p class="bio-desc" data-i18n="bioDesc">
                Expert SaaS et automatisations IA.<br>
                "Je vous aide à automatiser tout ce qui prend trop de temps."
            </p>
            <p>
                <span data-i18n="bioLinkText">Retrouvez mes services et infos sur :</span><br>
                <a href="http://philippe-eveilleau.fr" target="_blank" class="bio-link">http://philippe-eveilleau.fr</a>
            </p>
        </div>
    </footer>

    <script>
        // Traductions
        const translations = {
            fr: {
                title: "Générateur QR Code API",
                subtitle: "Micro-service offert par",
                inputPlaceholder: "Entrez une URL ou du texte à encoder",
                generateBtn: "Générer",
                placeholder: "Le QR Code apparaîtra ici",
                apiTitle: "Documentation Technique / API",
                apiComment1: "Format de la requête HTTP",
                apiComment2: "Exemple cURL / Terminal",
                apiComment3: "Utilisation dans n8n (HTTP Request Node)",
                bioTitle: "À propos de Philippe Eveilleau",
                bioDesc: "Expert SaaS et automatisations IA.<br>\"Je vous aide à automatiser tout ce qui prend trop de temps.\"",
                bioLinkText: "Retrouvez mes services et infos sur :"
            },
            en: {
                title: "QR Code Generator API",
                subtitle: "Micro-service provided by",
                inputPlaceholder: "Enter a URL or text to encode",
                generateBtn: "Generate",
                placeholder: "The QR Code will appear here",
                apiTitle: "Developer Documentation / API",
                apiComment1: "HTTP Request Format",
                apiComment2: "cURL Example",
                apiComment3: "Usage in n8n (HTTP Request Node)",
                bioTitle: "About Philippe Eveilleau",
                bioDesc: "SaaS & AI Automation Expert.<br>\"I help you automate everything that takes too much time.\"",
                bioLinkText: "Find my services and info at:"
            }
        };

        function setLanguage(lang) {
            // Update active button state
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${lang}`).classList.add('active');
            
            // Update Text Content
            const t = translations[lang];
            
            document.querySelector('[data-i18n="title"]').textContent = t.title;
            document.querySelector('[data-i18n="subtitle"]').textContent = t.subtitle;
            document.querySelector('[data-i18n="generateBtn"]').textContent = t.generateBtn;
            document.querySelector('[data-i18n="placeholder"]').textContent = t.placeholder;
            
            // API section
            document.querySelector('[data-i18n="apiTitle"]').textContent = t.apiTitle;
            document.querySelector('[data-i18n="apiComment1"]').textContent = t.apiComment1;
            document.querySelector('[data-i18n="apiComment2"]').textContent = t.apiComment2;
            document.querySelector('[data-i18n="apiComment3"]').textContent = t.apiComment3;

            // Bio section
            document.querySelector('[data-i18n="bioTitle"]').textContent = t.bioTitle;
            document.querySelector('[data-i18n="bioDesc"]').innerHTML = t.bioDesc;
            document.querySelector('[data-i18n="bioLinkText"]').textContent = t.bioLinkText;
            
            // Update Attributes
            document.getElementById('inputText').placeholder = t.inputPlaceholder;
            
            // Update HTML Lang attribute
            document.documentElement.lang = lang;
        }

        function generate() {
            const text = document.getElementById('inputText').value;
            const img = document.getElementById('preview');
            const placeholder = document.getElementById('placeholder-text');

            if(text) {
                img.style.opacity = '0.5';
                img.src = `/api/qr?text=${encodeURIComponent(text)}`;
                
                img.onload = function() {
                    img.style.display = 'block';
                    img.style.opacity = '1';
                    placeholder.style.display = 'none';
                };
            }
        }

        // Dynamically fill current hostname in docs
        const currentHost = window.location.host;
        document.getElementById('host-display').textContent = currentHost;
        document.getElementById('host-display-2').textContent = currentHost;

        // Event Listeners
        document.getElementById('inputText').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') generate();
        });

        // Auto-detect browser language
        const userLang = navigator.language || navigator.userLanguage; 
        if (userLang.startsWith('en')) {
            setLanguage('en');
        } else {
            setLanguage('fr');
        }
    </script>
</body>
</html>
